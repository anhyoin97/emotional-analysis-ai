<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ê°ì • ë¶„ì„ í”Œë«í¼</title>
    <style>
      body {
        margin: 0;
        font-family: "ë§‘ì€ ê³ ë”•", sans-serif;
        background-color: #f3f4f6;
        color: #333;
      }

      header {
        background-color: #0078d7;
        color: white;
        padding: 20px 40px;
        font-size: 1.5em;
        font-weight: bold;
        text-align: center;
      }

      main {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 40px;
        max-width: 900px;
        margin: 40px auto;
        padding: 0 20px;
      }

      section {
        background-color: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        flex: 1 1 400px;
        box-sizing: border-box;
      }

      textarea {
        width: 100%;
        height: 140px;
        box-sizing: border-box;
        border-radius: 8px;
        border: 1px solid #ccc;
        padding: 12px;
        font-size: 1em;
        resize: none;
      }

      button {
        margin-top: 16px;
        padding: 12px 24px;
        background-color: #0078d7;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1em;
      }

      button:hover {
        background-color: #005ea6;
      }

      .result-box {
        padding: 20px;
        border-left: 6px solid #0078d7;
        border-radius: 8px;
        background-color: #fefefe;
        transition: border-color 0.3s;
      }

      .result-item {
        margin-bottom: 12px;
        font-size: 1.05em;
      }

      .result-label {
        font-weight: bold;
      }

      .encouragement {
        margin-top: 20px;
        background-color: #f0f8ff;
        padding: 12px 16px;
        border-radius: 8px;
        border-left: 4px solid #00aaff;
        font-style: italic;
      }

      .score-guide {
        margin-top: 20px;
        font-size: 0.9em;
        color: #666;
        line-height: 1.4;
        background: #f7f7f7;
        padding: 10px 14px;
        border-radius: 8px;
      }

      footer {
        text-align: center;
        padding: 24px;
        font-size: 0.9em;
        color: #888;
        border-top: 1px solid #ddd;
        margin-top: 40px;
      }
    </style>
  </head>
  <body>
    <header>ğŸ“ ê°ì • ë¶„ì„ í”Œë«í¼</header>

    <main>
      <section>
        <h2>ì˜¤ëŠ˜ì˜ ê°ì •ì¼ê¸° ì‘ì„±</h2>
        <form id="diary-form">
          <textarea
            name="diary"
            placeholder="ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ì†”ì§í•˜ê²Œ ì ì–´ë³´ì„¸ìš”..."
          ></textarea>
          <button type="submit">ë¶„ì„í•˜ê¸°</button>
        </form>
      </section>

      <section>
        <h2>ë¶„ì„ ê²°ê³¼</h2>
        <div id="result">
          <p style="color: #888">
            ì¼ê¸°ë¥¼ ì‘ì„±í•˜ë©´ ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
          </p>
        </div>
      </section>
    </main>

    <footer>Â© HYOIN AN | 2025 ê°ì •ë¶„ì„ í”Œë«í¼</footer>

    <script>
      const emotionIcons = {
        ìš°ìš¸: "ğŸ˜¢",
        ë¶ˆì•ˆ: "ğŸ˜Ÿ",
        ë¶„ë…¸: "ğŸ˜ ",
        ê¸°ì¨: "ğŸ˜„",
        ìŠ¬í””: "ğŸ˜­",
        ì•ˆì •: "ğŸ˜Š",
        í”¼ë¡œ: "ğŸ˜©",
        ë¬´ê¸°ë ¥: "ğŸ˜",
        ì ˆë§: "ğŸ˜”",
        í¬ë§: "ğŸŒˆ",
      };

      const resultDiv = document.getElementById("result");
      const form = document.getElementById("diary-form");
      const button = form.querySelector("button");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        // ë¡œë”© í‘œì‹œ
        resultDiv.innerHTML = `<p style="color: #0078D7;">ğŸ§  ê°ì • ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>`;
        button.disabled = true;
        button.textContent = "ë¶„ì„ ì¤‘...";

        const formData = new FormData(e.target);
        const res = await fetch("/analyze", {
          method: "POST",
          body: formData,
        });

        button.disabled = false;
        button.textContent = "ë¶„ì„í•˜ê¸°";

        const data = await res.json();

        if (data.error) {
          resultDiv.innerHTML = `<p style="color:red;">âš ï¸ ë¶„ì„ ì‹¤íŒ¨: ${
            data.raw || data.detail
          }</p>`;
          return;
        }

        const color =
          data.score >= 81
            ? "#d9534f"
            : data.score >= 61
            ? "#f0ad4e"
            : data.score >= 31
            ? "#f9e79f"
            : "#5cb85c";
        const icon = emotionIcons[data.emotion] || "ğŸ§ ";

        resultDiv.innerHTML = `
      <div class="result-box" style="border-color: ${color};">
        <div class="result-item"><span class="result-label">ê°ì •:</span> ${icon} ${
          data.emotion
        }</div>
        <div class="result-item"><span class="result-label">ì ìˆ˜:</span> ${
          data.score
        }ì </div>
        <div class="result-item"><span class="result-label">ì´ìœ :</span> ${
          data.reason
        }</div>
        <div class="result-item"><span class="result-label">ì‘ì›ì˜ í•œë§ˆë””:</span> ${
          data.message
        }</div>
        <div class="encouragement">ğŸ’¬ ì˜¤ëŠ˜ì˜ ìœ„ë¡œ: â€œ${
          data.comfort || "ì˜¤ëŠ˜ë„ ì˜ ë²„í…¼ì–´ìš”. ìˆ˜ê³ í–ˆì–´ìš” :)"
        }â€</div>
        <div class="score-guide">
          <strong>ì ìˆ˜ í•´ì„ ì•ˆë‚´:</strong><br>
          âœ… 0~30: ê°ì • ì•ˆì • ìƒíƒœ<br>
          âš ï¸ 31~60: ê°€ë²¼ìš´ ê°ì • ë³€í™”<br>
          â— 61~80: ë¶€ì • ê°ì • ê°•í•¨<br>
          ğŸ”¥ 81~100: ê°ì •ì ìœ¼ë¡œ ë§¤ìš° í˜ë“  ìƒíƒœ
        </div>
      </div>
    `;
      });
    </script>
  </body>
</html>
